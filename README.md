# 画像を分類するプログラム

ディレクトリごとに分けて入れられた画像を分類する。

## 1. 画像データの前処理

```:shell
python make_data.py -s 保存ファイル ディレクトリ1 [ディレクトリ2 ...]
```

複数のディレクトリを指定すると，それぞれのディレクトリを1つのカテゴリとして，そのディレクトリ内に入っている画像を規格化，変換後の画像にカテゴリラベルを付け，まとめて指定された［保存ファイル］に保存する。

- 画像は150×150に規格化される。
- 画像データはRGBの3チャンネルからなるカラー画像を想定している。

## 2. 学習

```:shell
python neko_cross.py -d データファイル -e エポック数 -b バッチサイズ -f 交差検証分割数 -r 学習ログの保存ファイル -v ログレベル
```

手順1で保存した［データファイル］を指定すると学習を行う。
学習経過は -r オプションが指定されている場合は，［学習ログの保存ファイル］に保存される。

エポック数，バッチサイズ，交差検証分割数のデフォルト値（指定しない場合に使われる値）は以下の通り。

- エポック数：10
- バッチサイズ：20
- 交差検証分割数：5

なお，今のところ，学習後のネットワークを保存する機能はない。

## 3. 結果のグラフ化

```:shell
python plot_results.py -s 画像の保存ファイル 学習ログファイル
```

手順2で保存した学習ログをグラフ化する。
交差検証で複数回の検証を行っている場合は，分散をエラーバーで可視化する。
